# Вопросы безопасности для CloudBridge Relay Client

## TLS
- Используется только TLS 1.3
- Разрешены только безопасные шифры:
  - TLS_AES_256_GCM_SHA384
  - TLS_CHACHA20_POLY1305_SHA256
  - TLS_AES_128_GCM_SHA256
- Обязательная проверка сертификата
- Поддержка SNI (Server Name Indication)
- Возможность закрепления CA через конфиг
- На стороне сервера рекомендуется HSTS и OCSP stapling

## Аутентификация
- **JWT**: поддерживается только HS256, секрет должен совпадать с сервером relay
- **Keycloak**: OpenID Connect, автоматическое обновление JWKS, проверка ролей/прав
- **Claims**: требуется `sub` (subject) для идентификации пользователя
- **Проверка токена**: подпись, срок действия, issuer
- **Никогда не логируйте и не храните токены в открытом виде**

## Ограничение скорости
- По пользователю (по subject JWT)
- По умолчанию: 100 запросов/сек, burst 200
- Экспоненциальный backoff, максимум 3 повтора
- Все нарушения лимитов логируются

## Логирование и аудит
- Все операции логируются (уровень настраивается)
- Чувствительные данные (токены, секреты) не логируются
- Аудит-логи должны быть защищены и регулярно проверяться

## Обработка ошибок
- Все ошибки протокола обрабатываются и логируются
- Для ошибок с возможностью повтора используется экспоненциальный backoff
- Корректное завершение работы при фатальных ошибках

## Безопасное развёртывание
- Храните конфиги и секреты в защищённых местах (по возможности используйте переменные окружения)
- Ограничьте доступ к config.yaml и логам
- Регулярно обновляйте зависимости и проводите аудит безопасности

## Пентесты
- Регулярно тестируйте на уязвимости (TLS, JWT, replay, DoS)
- Проверяйте сертификаты сервера и JWT во всех тестах

## Контакты
- По вопросам безопасности обращайтесь к контактам, указанным в основном README. 